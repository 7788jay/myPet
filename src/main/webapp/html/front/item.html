<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->

<!-- Head BEGIN -->
<head>
    <meta charset="utf-8">
    <title>商品详情</title>

    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <!-- Global styles START -->
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- Global styles END -->

    <!-- Page level plugin styles START -->
    <link href="/assets/plugins/fancybox/source/jquery.fancybox.css" rel="stylesheet">
    <link href="/assets/plugins/carousel-owl-carousel/owl-carousel/owl.carousel.css" rel="stylesheet">
    <link href="/assets/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css">
    <link href="/assets/css/uncompressed/jquery-ui.css" rel="stylesheet" type="text/css"><!-- for slider-range -->
    <link href="/assets/plugins/rateit/src/rateit.css" rel="stylesheet" type="text/css">
    <!-- Page level plugin styles END -->

    <!-- Theme styles START -->
    <link href="/assets/css/components.css" rel="stylesheet">
    <link href="/assets/frontend/layout/css/style.css" rel="stylesheet">
    <link href="/assets/frontend/pages/css/style-shop.css" rel="stylesheet" type="text/css">
    <link href="/assets/frontend/layout/css/style-responsive.css" rel="stylesheet">
    <link href="/assets/frontend/layout/css/themes/green.css" rel="stylesheet" id="style-color">
    <link href="/assets/frontend/layout/css/custom.css" rel="stylesheet">
    <!-- Theme styles END -->
    <!--样式区-->
    <style>
        .ms-controller, .ms-important, [ms-controller], [ms-important] {
            visibility: hidden;
        }
    </style>
</head>
<!-- Head END -->

<!-- Body BEGIN -->
<body class="ecommerce" ms-controller="pet-item" id="pet-item">
<!--头部-->
<div ms-include-src="'public/head.html'"></div>

<div class="main">
    <div class="container">
        <!-- BEGIN SIDEBAR & CONTENT -->
        <div class="row margin-bottom-40">
            <!-- 销售排行榜 -->
            <div class="sidebar col-md-3 col-sm-5" ms-include-src="'./public/hotPets-left.html'"></div>

            <!-- begin商品详情 -->
            <div class="col-md-9 col-sm-7">
                <div class="product-page">
                    <div class="row">
                        <div class="col-md-6 col-sm-6">
                            <div class="product-main-image" style="height: 350px;">
                                <img ms-attr-src="currentImage" alt="Cool green dress with red bell"
                                     class="img-responsive" ms-attr-data-BigImgsrc="currentImage">
                            </div>
                            <div class="product-other-images">
                                <a ms-repeat="data.image" ms-click="switchPic(el)" href="javascript:;">
                                    <img alt="Berry Lace Dress" ms-attr-src="el">
                                </a>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6">
                            <h1>{{data.name}}</h1>
                            <div class="price-availability-block clearfix">
                                <div class="price">
                                    <strong><span>￥</span>{{data.price}}</strong>
                                </div>
                                <!--<div class="availability">
                                    性别: <strong>{{data.sex}}</strong>
                                </div>-->
                            </div>
                            <div class="product-page-options">
                                <div class="pull-left">
                                    <label class="control-label">性别：{{data.sex | sexFilter}}</label>
                                </div>
                                <div class="pull-left">
                                    <label class="control-label">年龄： {{data.age}} 年</label>
                                </div>
                            </div>
                            <div class="product-page-options">
                                <div class="pull-left">
                                    <label class="control-label">重量：{{data.weight}} KG</label>
                                </div>
                            </div>
                            <div class="product-page-cart">
                                <div class="product-quantity">
                                    <input id="product-quantity" type="text" value="1" readonly
                                           class="form-control input-sm">
                                </div>
                                <button ms-if="data.status" class="btn btn-primary" type="button" ms-click="addToCart(data.code)">
                                    加入购物车
                                </button>
                                <button disabled ms-if="!data.status" class="btn btn-primary" type="button">
                                    该商品已下架
                                </button>
                                &nbsp;<font color="red">剩余库存:{{data.quantity}}</font>
                            </div>
                        </div>

                        <div class="product-page-content">
                            <ul id="myTab" class="nav nav-tabs">
                                <li class="active"><a href="#Description" data-toggle="tab">宠物描述</a></li>
                            </ul>
                            <div id="myTabContent" class="tab-content">
                                <div class="tab-pane fade in active" id="Description">
                                    {{data.description | html}}
                                </div>
                            </div>
                        </div>

                        <div class="sticker sticker-sale"></div>
                    </div>
                </div>
            </div>
            <!-- END 商品详情 -->
        </div>
        <!-- END SIDEBAR & CONTENT -->

        <!-- BEGIN 相似宠物 -->
        <div class="row margin-bottom-40">
            <div class="col-md-12 col-sm-12">
                <h2>类似宠物</h2>
                <div class="owl-carousel owl-carousel4">
                    <div ms-repeat="similarPets" data-repeat-rendered="layoutInit">
                        <div class="product-item">
                            <div class="pi-img-wrapper">
                                <img ms-attr-src="el.image" class="img-responsive" ms-attr-alt="el.name" style="height: 280px;"/>
                                <div>
                                    <a ms-attr-href="el.image" class="btn btn-default fancybox-button">查看</a>
                                </div>
                            </div>
                            <h3><a ms-attr-href="item.html?code={{el.code}}">{{el.name}}</a></h3>
                            <div class="pi-price">￥{{el.price}}</div>
                            <a href="javascript:;" ms-click="addToCart1(el.code)" class="btn btn-default add2cart">加入购物车</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END 相似宠物 -->
    </div>
</div>

<!--footer-->
<div ms-include-src="'public/foot.html'"></div>

<!-- Load javascripts at bottom, this will reduce page load time -->
<!-- BEGIN CORE PLUGINS(REQUIRED FOR ALL PAGES) -->
<!--[if lt IE 9]>
<script src="/assets/plugins/respond.min.js"></script>
<![endif]-->
<script src="/assets/js/jquery.min.js" type="text/javascript"></script>
<script src="/assets/plugins/jquery-migrate.min.js" type="text/javascript"></script>
<script src="/assets/bootstrap/bootstrap.min.js" type="text/javascript"></script>
<script src="/assets/frontend/layout/scripts/back-to-top.js" type="text/javascript"></script>
<script src="/assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
<script src="/libs/avalon/avalon.shim.min.js"></script>
<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE LEVEL JAVASCRIPTS (REQUIRED ONLY FOR CURRENT PAGE) -->
<script src="/assets/plugins/fancybox/source/jquery.fancybox.pack.js" type="text/javascript"></script><!-- pop up -->
<script src="/assets/plugins/carousel-owl-carousel/owl-carousel/owl.carousel.min.js" type="text/javascript"></script>
<!-- slider for products -->
<script src='/assets/plugins/zoom/jquery.zoom.min.js' type="text/javascript"></script><!-- product zoom -->
<script src="/assets/plugins/bootstrap-touchspin/bootstrap.touchspin.js" type="text/javascript"></script>
<!-- Quantity -->
<script src="/assets/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>
<script src="/assets/plugins/rateit/src/jquery.rateit.js" type="text/javascript"></script>

<script src="/assets/frontend/layout/scripts/layout.js" type="text/javascript"></script>
<script src="/js/common-front.js" type="text/javascript"></script>
<script type="text/javascript">
    jQuery(document).ready(function () {
        var petItem = avalon.define({
            $id: "pet-item",
            currentImage: "",   //当前显示图片
            data: {
                categoryCode: "",
                code: "",   //代码
                name: "",
                price: "",
                sex: "",     //性别
                weight: "",  //重量
                age: "",    //年龄
                quantity: "", //库存
                image: [],
                description: "", //描述
                status: 1    //状态
            },
            similarPets: [],  //类似宠物
            //初始化
            init: function () {
                var code = getQueryString('code');

                $.ajax({
                    url: "/pet/front/item/queryOne?code=" + code,
                    type: "GET",
                    dataType: "json",
                    success: function (result) {
                        petItem.data.code = result.code;
                        petItem.data.categoryCode = result.categoryCode;
                        //查询类似宠物
                        petItem.querySimilar();
                        petItem.data.name = result.name;
                        petItem.data.price = result.price;
                        petItem.data.weight = result.weight;
                        petItem.data.age = result.age;
                        petItem.data.sex = result.sex;
                        petItem.data.quantity = result.quantity;
                        petItem.data.description = result.description;
                        petItem.data.status = result.status;
                        petItem.data.image = result.image.split(",");
                        petItem.currentImage = petItem.data.image[0];
                        $('.product-main-image').zoom({url: petItem.currentImage});
                    }
                });
            },
            //查询类似宠物
            querySimilar: function () {
                $.ajax({
                    url: "/pet/front/petList/queryByCategory?categoryCode="+petItem.data.categoryCode,
                    type: "GET",
                    dataType: "json",
                    success: function (result) {
                        result.forEach(function (el) {
                            el.image = el.image.split(",")[0];
                        });
                        petItem.similarPets = result;
                    }
                });
            },
            //切换图片
            switchPic: function (url) {
                petItem.currentImage = url;
                $('.product-main-image').zoom({url: url});
            },
            //加入购物车
            addToCart: function (code) {
                //获取数量
                var num = $('#product-quantity').val();
                $.ajax({
                    url: "/pet/front/cart/add?code=" + code + "&num=" + num,
                    type: "GET",
                    dataType: "json",
                    success: function (result) {
                        if (result.success) {
                            window.location.href = "cart-success.html";
                        }
                    }
                });
            },
            //加入购物车
            addToCart1: function (code) {
                $.ajax({
                    url: "/pet/front/cart/add?code=" + code,
                    type: "GET",
                    dataType: "json",
                    success: function (result) {
                        if (result.success) {
                            window.location.href = "cart-success.html";
                        }
                    }
                });
            },
            //界面初始化
            layoutInit: function () {
                Layout.init();
                Layout.initOWL();
                Layout.initImageZoom();
                Layout.initTouchspin();
            }
        });
        avalon.scan($('#pet-item')[0], petItem);
        petItem.init();
    });
</script>
<!-- END PAGE LEVEL JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>